# =====================================
# ODAVL Studio - Staging Environment
# =====================================
# This file contains staging-specific environment variables
# Copy to .env.staging in apps/studio-hub/

# =====================================
# Environment
# =====================================
NODE_ENV=staging
NEXT_PUBLIC_APP_URL=https://staging.odavl.studio
NEXT_PUBLIC_API_URL=https://staging.odavl.studio/api

# =====================================
# Database (Staging PostgreSQL)
# =====================================
# Use separate database for staging to avoid production data contamination
DATABASE_URL=postgresql://postgres:staging_password@staging-db.odavl.studio:5432/odavl_staging

# Alternative: Railway/Supabase/Neon staging database
# DATABASE_URL=postgresql://user:pass@staging-host:5432/odavl_staging

# =====================================
# NextAuth Configuration
# =====================================
# Generate with: openssl rand -base64 32
NEXTAUTH_SECRET=staging_secret_min_32_chars_replace_me_in_production
NEXTAUTH_URL=https://staging.odavl.studio

# =====================================
# OAuth Providers (Staging Apps)
# =====================================
# Create separate OAuth apps for staging to avoid callback URL conflicts

# GitHub OAuth (Staging)
# Create at: https://github.com/settings/developers
# Callback URL: https://staging.odavl.studio/api/auth/callback/github
GITHUB_ID=staging_github_oauth_app_id
GITHUB_SECRET=staging_github_oauth_secret

# Google OAuth (Staging)
# Create at: https://console.cloud.google.com/
# Callback URL: https://staging.odavl.studio/api/auth/callback/google
GOOGLE_ID=staging_google_oauth_client_id
GOOGLE_SECRET=staging_google_oauth_client_secret

# =====================================
# AWS S3 Storage (Staging Bucket)
# =====================================
# Use separate bucket for staging to isolate test data
AWS_ACCESS_KEY_ID=staging_aws_access_key
AWS_SECRET_ACCESS_KEY=staging_aws_secret_key
AWS_REGION=us-east-1
AWS_S3_BUCKET=odavl-staging-storage

# Optional: Use MinIO for staging
# AWS_ENDPOINT_URL=http://staging-minio:9000

# =====================================
# Internal API Key
# =====================================
# Generate with: openssl rand -base64 32
INTERNAL_API_KEY=staging_internal_api_key_min_32_chars

# =====================================
# Email Service (Staging)
# =====================================
# Use test email service (e.g., Mailtrap, Mailhog)
SMTP_HOST=smtp.mailtrap.io
SMTP_PORT=2525
SMTP_USER=staging_smtp_user
SMTP_PASS=staging_smtp_password
SMTP_FROM=staging@odavl.studio

# =====================================
# Monitoring & Error Tracking (Staging)
# =====================================
# Sentry (staging project)
SENTRY_DSN=https://staging_key@sentry.io/staging_project_id
SENTRY_ENVIRONMENT=staging

# =====================================
# Feature Flags (Staging)
# =====================================
# Enable experimental features in staging
NEXT_PUBLIC_ENABLE_BETA_FEATURES=true
NEXT_PUBLIC_ENABLE_DEBUG_MODE=true
NEXT_PUBLIC_ENABLE_TEST_DATA=true

# =====================================
# Rate Limiting (Staging - More Lenient)
# =====================================
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_MAX_REQUESTS=1000

# =====================================
# Logging (Verbose in Staging)
# =====================================
LOG_LEVEL=debug
ENABLE_REQUEST_LOGGING=true
ENABLE_QUERY_LOGGING=true

# =====================================
# CORS (Staging - Permissive)
# =====================================
ALLOWED_ORIGINS=https://staging.odavl.studio,http://localhost:3000

# =====================================
# Stripe (Test Mode)
# =====================================
STRIPE_PUBLISHABLE_KEY=pk_test_staging_key
STRIPE_SECRET_KEY=sk_test_staging_key
STRIPE_WEBHOOK_SECRET=whsec_staging_webhook_secret

# =====================================
# Database Connection Pool (Staging)
# =====================================
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# =====================================
# Redis (Optional - Staging)
# =====================================
REDIS_URL=redis://staging-redis:6379

# =====================================
# Background Jobs (Staging)
# =====================================
ENABLE_BACKGROUND_JOBS=true
JOB_CONCURRENCY=2

# =====================================
# Build Configuration
# =====================================
NEXT_TELEMETRY_DISABLED=1
SKIP_ENV_VALIDATION=false

# =====================================
# Setup Instructions
# =====================================
# 1. Copy this file:
#    cp .env.staging.example apps/studio-hub/.env.staging
#
# 2. Update all placeholder values with real credentials
#
# 3. Create staging database:
#    - Option A: Railway (recommended)
#      https://railway.app → New Project → PostgreSQL
#    - Option B: Supabase
#      https://supabase.com → New Project
#    - Option C: Neon
#      https://neon.tech → New Project
#    - Option D: Docker
#      docker run -d -p 5433:5432 \
#        -e POSTGRES_PASSWORD=staging_password \
#        -e POSTGRES_DB=odavl_staging \
#        --name odavl-staging-db postgres:15
#
# 4. Run migrations:
#    cd apps/studio-hub
#    DATABASE_URL="..." pnpm prisma migrate deploy
#
# 5. Seed staging data:
#    pnpm db:seed
#
# 6. Deploy to Vercel/Railway:
#    vercel --prod --env-file .env.staging
#
# =====================================
# Security Notes
# =====================================
# - Never commit this file with real credentials
# - Use different secrets than production
# - Rotate credentials regularly (every 90 days)
# - Use test mode for payment providers
# - Enable debug logging for troubleshooting
# - Use separate OAuth apps to avoid callback conflicts
# - Isolate staging data from production
