{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "$id": "https://odavl.com/schemas/gates.json",
  "title": "ODAVL Quality Gates Configuration",
  "description": "Schema for ODAVL quality gates configuration that defines safety thresholds for autonomous code improvement",
  "type": "object",
  "properties": {
    "eslint": {
      "type": "object",
      "description": "ESLint warning thresholds",
      "properties": {
        "deltaMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum allowed increase in ESLint warnings"
        },
        "absoluteMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum absolute number of ESLint warnings allowed"
        }
      },
      "required": ["deltaMax", "absoluteMax"],
      "additionalProperties": false
    },
    "typeErrors": {
      "type": "object",
      "description": "TypeScript error thresholds",
      "properties": {
        "deltaMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum allowed increase in TypeScript errors"
        },
        "absoluteMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum absolute number of TypeScript errors allowed"
        }
      },
      "required": ["deltaMax", "absoluteMax"],
      "additionalProperties": false
    },
    "bundleKB": {
      "type": "object",
      "description": "Bundle size thresholds in kilobytes",
      "properties": {
        "deltaMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum allowed increase in bundle size (KB)"
        },
        "absoluteMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum absolute bundle size allowed (KB)"
        }
      },
      "required": ["deltaMax", "absoluteMax"],
      "additionalProperties": false
    },
    "buildMs": {
      "type": "object",
      "description": "Build time thresholds in milliseconds",
      "properties": {
        "deltaPctMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum allowed percentage increase in build time"
        },
        "absoluteMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum absolute build time allowed (ms)"
        }
      },
      "required": ["deltaPctMax", "absoluteMax"],
      "additionalProperties": false
    },
    "policy": {
      "type": "object",
      "description": "Policy violation thresholds",
      "properties": {
        "violationsMax": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum allowed policy violations"
        },
        "strictMode": {
          "type": "boolean",
          "description": "Whether to enforce strict policy compliance"
        }
      },
      "required": ["violationsMax", "strictMode"],
      "additionalProperties": false
    },
    "shadow": {
      "type": "object",
      "description": "Shadow testing configuration",
      "properties": {
        "mustPass": {
          "type": "boolean",
          "description": "Whether shadow testing must pass for verification"
        },
        "timeoutMs": {
          "type": "number",
          "minimum": 1000,
          "description": "Timeout for shadow testing in milliseconds"
        }
      },
      "required": ["mustPass", "timeoutMs"],
      "additionalProperties": false
    },
    "security": {
      "type": "object",
      "description": "Security vulnerability thresholds",
      "properties": {
        "highCVEs": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum allowed high-severity CVEs"
        },
        "mediumCVEs": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum allowed medium-severity CVEs"
        },
        "licenseIssues": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum allowed license compliance issues"
        }
      },
      "required": ["highCVEs", "mediumCVEs", "licenseIssues"],
      "additionalProperties": false
    },
    "complexity": {
      "type": "object",
      "description": "Code complexity thresholds",
      "properties": {
        "maxPerFile": {
          "type": "number",
          "minimum": 1,
          "description": "Maximum complexity score per file"
        },
        "maxTotal": {
          "type": "number",
          "minimum": 1,
          "description": "Maximum total complexity score"
        }
      },
      "required": ["maxPerFile", "maxTotal"],
      "additionalProperties": false
    },
    "coverage": {
      "type": "object",
      "description": "Test coverage thresholds",
      "properties": {
        "minPercent": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Minimum test coverage percentage required"
        },
        "deltaMin": {
          "type": "number",
          "description": "Minimum change in coverage (can be negative)"
        }
      },
      "required": ["minPercent", "deltaMin"],
      "additionalProperties": false
    },
    "pilot": {
      "type": "object",
      "description": "Pilot program readiness checks",
      "properties": {
        "readiness": {
          "type": "boolean",
          "description": "Whether the system is ready for pilot deployment"
        },
        "securityPassed": {
          "type": "boolean",
          "description": "Whether security requirements have been met"
        }
      },
      "required": ["readiness", "securityPassed"],
      "additionalProperties": false
    }
  },
  "required": [
    "eslint",
    "typeErrors",
    "bundleKB",
    "buildMs",
    "policy",
    "shadow",
    "security",
    "complexity",
    "coverage",
    "pilot"
  ],
  "additionalProperties": false
}